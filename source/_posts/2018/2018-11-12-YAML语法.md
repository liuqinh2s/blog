---
title: YAML语法
categories: [配置语言]
comments: true
---

在学Spring Boot的时候，application.yml使用的就是YAML语法，顺便过来学习一下，有过JSON、XML的基础，应该可以学的很快。

[YAML](https://zh.wikipedia.org/wiki/YAML)是专门用来写配置文件的语言，强调以数据为中心，写起来非常简洁方便。

## 基本语法

- 大小写敏感
- 冒号、连字符后面一定要加一个空格，再写数据
- 使用缩进表示层级关系
- 缩进时不允许使用Tab键，只允许使用空格
- 缩进的空格数目不重要，只要相同层级的元素左对齐即可
- `#`注释一行

YAML支持的数据结构有三种：

- **对象**：键值对的集合，又称为映射（mapping）/ 哈希（hashes）/ 字典（dictionary）
- **数组**：一组按次排列的值，又称为序列（sequence）/ 列表（list）
- **纯量(scalars)**：单个的、不可再分的值

下面分别介绍这三种数据结构的表示方法：

## 对象

对象的一组键值对，使用冒号结构表示

```
title: hello world
```

行内表示：

```
maps: {title: hello world, date: 2017/11/11}
```

## 数组

一组连词线开头的行，构成一个数组

```
- Cat
- Dog
- Pig
```

行内表示法：

```
animals: [Cat, Dog, Pig]
```

数据结构的子成员是一个数组，则可以在该项下面缩进一个空格

```
-
 - Cat
 - Dog
 - Pig
```

## 纯量

纯量是最基本的，不可再分割的值。

- 字符串
- 布尔值
- 整数
- 浮点数
- Null
- 时间
- 日期

### 数值

数值直接以[字面量](https://baike.baidu.com/item/%E5%AD%97%E9%9D%A2%E9%87%8F)的形式表示

```
number: 12.30
```

### 布尔值

```
isSet: true
```

### Null

`Null`用`~`表示

```
parent: ~
```

### 日期

```
date: 2017-11-11
```

### 字符串

字符串默认不使用引号表示

```
str: 这是一行字符串
```

如果字符串之中包含空格或特殊字符，需要放在引号之中

```
str: '内容: 字符串'
```

单引号和双引号都可以使用，双引号中转义是有效的，单引号中转义是无效的。

单引号之中如果还有单引号，必须连续使用两个单引号转义。

```
str: 'labor''s day' 
```

字符串可以写成多行，从第二行开始，必须有一个单空格缩进。换行符会被转为空格。

```
str: 这是一段
  多行
  字符串
```

多行字符串可以使用`|`保留换行符，也可以使用`>`折叠换行。

```
this: |
  Foo
  Bar
that: >
  Foo
  Bar
```

转为 JSON 代码如下。

```JSON
{ this: 'Foo\nBar\n', that: 'Foo Bar\n' }
```

`+`表示保留文字块末尾的换行，`-`表示删除字符串末尾的换行。

```
s1: |
  Foo

s2: |+
  Foo


s3: |-
  Foo
```

转为 JSON 代码如下。

```
{ s1: 'Foo\n', s2: 'Foo\n\n\n', s3: 'Foo' }
```

字符串之中可以插入 HTML 标记。

```
message: |

  <p style="color: red">
    段落
  </p>
```

转为 JSON 如下。

```
{ message: '\n<p style="color: red">\n  段落\n</p>\n' }
```

## 引用

锚点`&`和别名`*`，可以用来引用。

```YAML
default: &defaults
  adapter: postgress
  host: localhost

development: 
  database: myapp_development
  <<: *defaults

test:
  database: myapp_test
  <<: *defaults
```

等同于下面的代码:

```
defaults:
  adapter:  postgres
  host:     localhost

development:
  database: myapp_development
  adapter:  postgres
  host:     localhost

test:
  database: myapp_test
  adapter:  postgres
  host:     localhost
```

`&`用来建立锚点(defaults)，`<<`表示合并到当前数据，`*`表示引用锚点

下面是另一个例子

```
- &showshell Steve
- Clark
- Brian
- Oren
- *showshell
```

转为 JSON 代码如下

```
[ 'Steve', 'Clark', 'Brian', 'Oren', 'Steve' ]
```




