---
title: '《代码整洁之道》读书笔记--第6章:对象和数据结构'
tags:
  - 编程范式
categories:
  - 读书笔记
  - 《代码整洁之道》
comments: true
---

## 数据、对象的反对称性

对象把数据隐藏于抽象之后，暴露操作数据的方法。数据结构暴露其数据，没有提供有意义的函数。

过程式形状代码
```java
public class Square{
    public Point topLeft;
    public double side;
}

public class Rectangle{
    public Point topLeft;
    public double height;
    public double width;
}

public class Circle{
    public Point center;
    public double radius;
}

public class Geometry{
    public final double PI = 3.14159;
    public double area(Object shape) throws NoSuchShapeException{
        if(shape instanceof Square){
            Square s = (Square)shape;
            return s.side*s.side;
        }else if(shape instanceof Rectangle){
            Rectangle r = (Rectangle)shape;
            return r.height*r.width;
        }else if(shape instanceof Circle){
            Circle c = (Circle)shape;
            return c.radius*c.radius*PI;
        }
        throw new NoSuchShapeException();
    }
}
```

过程式的代码的优点在于，如果给Geometry添加一个新的函数`perimeter`，那些形状类根本不会受任何影响，只需将函数加入到Geometry中即可。而如果新加一个类型，则要修改area函数。

多态式形状
```java
public class Square implements Shape{
    private Point topLeft;
    private double side;

    @Override
    public double area(){
        return side*side;
    }
}

public class Rectangle implements Shape{
    private Point topLeft;
    private double height;
    private double width;

    @Override
    public double area(){
        return height*width;
    }
}

public class Circle implements Shape{
    private Point center;
    private double radius;
    public final double PI = 3.14159;

    @Override
    public double area(){
        return radius*radius*PI;
    }
}
```

面向对象代码便于添加新的类而不用改变已有的代码，但如果要新加一个`perimeter`方法，就要修改所有的类了。这一点上跟使用数据结构的过程式代码截然相反。