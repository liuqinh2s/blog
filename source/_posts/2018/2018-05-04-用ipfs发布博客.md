---
title: 用ipfs发布博客
date: 2018-05-04
categories: [区块链, ipfs]
comments: true
---

ipfs是一个p2p的网络

## 常用ipfs命令

```
ipfs add -r mysite
// 通过上一步可以得到很多个哈希值（每个目录和文件都有一个），把根目录对应的哈希值拿出来用
ipfs name publish QmZyenFLZtm9rk2B98ZqRAFYRkzhqyUruKBSsdZUnKk9ek
```

第二步实际上是把这个站点的根目录映射到了你的 `ipfs id` 上面，你的这个id是固定的。之后你每次更新这个站点下的内容都要 `ipfs add -r mysite` 一次，然后把根目录对应的哈希值重新映射到你的 ipfs id 上。

然后你访问ipfs站点的时候，可以这样访问：`https://ipfs.io/ipns/your_ipfs_id`，如果你的浏览器装了ipfs插件就可以自动解析这个网址，从而直接用ipfs协议来访问站点了。

>注意your_ipfs_id是指你的ipfs id，你可以用命令`ipfs id`查看你的id是什么，相信我的读者不会蠢到直接复制粘贴your_ipfs_id。

## hexo生成的博客，缺失css和js的问题

在hexo的config里面，有个root，这个root就是用来给css和js等资源指定目录的，所以你要改成：`/ipns/your_ipfs_id/`

如果你想同时在git pages上面，和ipfs上面发布你的博客，那么root这个属性必定就冲突了，因为在git pages上面发布的时候，直接填`/`就行了（他是直接发布在像：`liuqinh2s.github.io`，这个域名后面，也就是子域名的根目录，不像ipfs那样会加个`/ipns/your_ipfs_id`这种目录）。那么你就只能搞两个博客工程了，新发布博客的时候，就要同时修改两个地方。

比如我是这样做的，我建了一个ipfs文件夹，里面存放我所有发布在ipfs上的资源，所以我会把我的博客复制一份到这个文件夹里面，更新博客的时候，复制一份博客文件到这边，git pages那边要发布一次，然后ipfs这边也要发布一次。

访问我的ipfs站点：https://ipfs.io/ipns/QmT7mga4wwTLNFCrtt1FbvLgmxTWZyKGRsrnFZNMoHdEJa/

## 使用脚本自动化push

为了实现自动push，我自己写了个脚本，可以同时把博客push到git pages和ipfs上：https://gist.github.com/liuqinh2s/0864ed7799b161bb2f048b4fab867d5a

在你的博客目录下新建一个`push.sh`，然后把代码复制粘贴，保存，以后每次push的时候执行：`bash push.sh`
